# Needed to use llvm-strip when packaging.
export TOOLCHAIN_PREFIX="llvm-"

MOZBUILD="$HOME/.mozbuild"

export CC="$MOZBUILD/clang/bin/clang"
export CXX="$MOZBUILD/clang/bin/clang++"
export HOST_CC="$MOZBUILD/clang/bin/clang"
export HOST_CXX="$MOZBUILD/clang/bin/clang++"

#ac_add_options --enable-bootstrap
ac_add_options --target=aarch64-unknown-linux-gnu
ac_add_options --enable-linker=lld
ac_add_options --enable-application=b2g
ac_add_options --with-app-basename=b2g
ac_add_options --enable-default-toolkit=cairo-gtk3-wayland-only

ac_add_options --enable-forkserver

ac_add_options --disable-updater

# Set the api-daemon port
ac_add_options --with-api-daemon-port=8081

# Pretend to be an official build to be in a release configuration.
export MOZILLA_OFFICIAL=1

ac_add_options --disable-tests

# Disable telemetry
ac_add_options MOZ_TELEMETRY_REPORTING=

# Use sccache
ac_add_options --with-ccache=sccache

if [ "${B2G_DEBUG:-0}" != "0" ]; then
  ac_add_options --enable-debug
  ac_add_options --enable-debug-symbols
else
  if [ "${MOZ_DISABLE_LTO:-0}" = "0" ]; then
    # Enable Rust <-> C++ LTO
    ac_add_options --enable-lto
    export MOZ_LTO=cross
    ac_add_options --disable-profiling
  fi
fi

mk_add_options AUTOCLOBBER=1

ac_add_options --enable-safebrowsing
